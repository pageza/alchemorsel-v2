# Alchemorsel E2E Testing Suite\n\nComprehensive end-to-end testing suite for the Alchemorsel recipe management application using Puppeteer and Node.js test runner.\n\n## 🧪 Test Coverage\n\n### Authentication Flow Tests\n- User registration with dietary preferences and allergies\n- Login/logout functionality with session persistence\n- Password validation and error handling\n- Social login integration (if available)\n- Remember me functionality\n- Token expiration and refresh handling\n\n### Recipe Management Tests\n- Recipe browsing and pagination\n- Search functionality with filters\n- Recipe details view with all components\n- Manual recipe creation with dynamic fields\n- Recipe editing and updates\n- Recipe deletion and confirmation\n- Favorite/unfavorite functionality\n\n### AI Recipe Generation Tests\n- Natural language recipe prompts\n- Recipe modification with additional prompts\n- Dietary restriction handling\n- Complex prompt processing\n- Generated recipe saving\n- Error handling for AI service failures\n- Loading states and timeouts\n\n### User Profile Tests\n- Profile information updates\n- Dietary preferences management\n- Allergy information updates\n- Profile image upload\n- Password changes\n- Form validation and error handling\n\n### Integration Tests\n- Complete user journey workflows\n- Cross-feature interactions\n- Session persistence across page refreshes\n- Multi-tab behavior\n- Error recovery scenarios\n- Network failure handling\n\n## 🚀 Getting Started\n\n### Prerequisites\n\n- Node.js 18+ \n- npm or yarn\n- Running Alchemorsel backend and frontend services\n- PostgreSQL database with test data\n\n### Installation\n\n```bash\n# Clone the repository\ngit clone <repository-url>\ncd alchemorsel-v2/ui-tests\n\n# Install dependencies\nnpm install\n\n# Copy environment configuration\ncp .env.example .env\n\n# Edit .env file with your test configuration\nvim .env\n```\n\n### Environment Configuration\n\nCreate a `.env` file with the following variables:\n\n```bash\n# Application URLs\nBASE_URL=http://localhost:5173\nAPI_BASE_URL=http://localhost:8080\n\n# Browser Configuration\nHEADLESS=true\nVIEWPORT_WIDTH=1280\nVIEWPORT_HEIGHT=720\n\n# Test Data\nTEST_USER_EMAIL=test@alchemorsel.com\nTEST_USER_PASSWORD=TestPassword123!\n\n# Test Options\nSCREENSHOT_ON_FAILURE=true\nTEST_RETRIES=2\nDEFAULT_TIMEOUT=30000\n```\n\n## 🎯 Running Tests\n\n### Run All Tests\n\n```bash\nnpm test\n```\n\n### Run Specific Test Suites\n\n```bash\n# Authentication tests\nnpm run test:auth\n\n# Recipe tests\nnpm run test:recipes\n\n# Profile tests\nnpm run test:profile\n\n# Integration tests\nnpm run test:integration\n```\n\n### Advanced Test Execution\n\n```bash\n# Run with browser UI (headed mode)\nnpm test -- --headed\n\n# Run specific test pattern\nnpm test -- --test auth\n\n# Run with verbose output\nnpm test -- --verbose\n\n# Run in watch mode\nnpm test -- --watch\n\n# Run with custom retries\nnpm test -- --retries 3\n\n# Generate coverage report\nnpm test -- --coverage\n```\n\n### Custom Test Runner\n\nUse the enhanced test runner for more control:\n\n```bash\n# Run tests with custom options\nnode scripts/run-tests.js --test recipes --headed --verbose\n\n# Show help\nnode scripts/run-tests.js --help\n```\n\n## 📊 Test Reports\n\nTest runs generate comprehensive reports in the `reports/` directory:\n\n- **JSON Report**: `reports/test-results.json` - Machine-readable results\n- **HTML Report**: `reports/test-report.html` - Human-friendly visual report\n- **JUnit XML**: `reports/junit.xml` - CI/CD integration format\n\n### Screenshots and Videos\n\n- **Screenshots**: Automatically captured on test failures in `screenshots/`\n- **Videos**: Optional recording of test runs in `videos/`\n\n## 🏗️ Test Structure\n\n```\nui-tests/\n├── helpers/           # Test utilities and helper classes\n│   ├── browser.js     # Browser management and Puppeteer utilities\n│   ├── auth.js        # Authentication helper methods\n│   ├── recipes.js     # Recipe-related helper methods\n│   └── fixtures.js    # Test data and fixtures\n├── tests/             # Test files organized by feature\n│   ├── auth/          # Authentication tests\n│   ├── recipes/       # Recipe management tests\n│   ├── profile/       # User profile tests\n│   └── integration/   # End-to-end integration tests\n├── scripts/           # Test runner and utility scripts\n├── reports/           # Generated test reports\n├── screenshots/       # Failure screenshots\n└── videos/           # Test recordings\n```\n\n## 🧰 Helper Classes\n\n### BrowserManager\n\nHandles browser lifecycle, navigation, and common operations:\n\n```javascript\nconst browser = new BrowserManager();\nawait browser.launch();\nawait browser.navigate('/recipes');\nawait browser.clickElement('[data-testid=\"recipe-card\"]');\nawait browser.screenshot('recipe-page');\n```\n\n### AuthHelper\n\nManages authentication flows:\n\n```javascript\nconst auth = new AuthHelper(browser);\nawait auth.login('user@example.com', 'password');\nconst isLoggedIn = await auth.isLoggedIn();\nawait auth.logout();\n```\n\n### RecipeHelper\n\nHandles recipe-specific operations:\n\n```javascript\nconst recipes = new RecipeHelper(browser);\nawait recipes.searchRecipes('pasta');\nconst recipeDetails = await recipes.viewRecipeDetails('recipe-id');\nawait recipes.toggleFavorite();\n```\n\n## 🎯 Test Data Selectors\n\nTests rely on `data-testid` attributes for reliable element selection:\n\n```html\n<!-- Good: Use data-testid for test targeting -->\n<button data-testid=\"login-submit\">Login</button>\n<input data-testid=\"email-input\" type=\"email\" />\n<div data-testid=\"recipe-card\" data-recipe-id=\"123\">\n```\n\n### Required Test IDs\n\nEnsure these test IDs are present in the frontend:\n\n#### Authentication\n- `login-form`, `register-form`\n- `email-input`, `password-input`, `username-input`\n- `login-submit`, `register-submit`\n- `logout-button`, `user-menu`\n\n#### Recipes\n- `recipe-list`, `recipe-card-{id}`\n- `recipe-search`, `filter-category-{name}`\n- `recipe-detail`, `recipe-title`, `ingredients-list`\n- `favorite-button`, `save-recipe`\n\n#### AI Generation\n- `recipe-generator`, `recipe-prompt`\n- `generate-button`, `generated-recipe`\n- `modify-prompt`, `save-generated-recipe`\n\n#### Profile\n- `profile-form`, `first-name-input`, `bio-input`\n- `dietary-{preference}`, `allergy-{allergen}`\n- `save-profile`, `change-password`\n\n## 🔧 Debugging Tests\n\n### Visual Debugging\n\n```bash\n# Run tests with browser UI\nnpm test -- --headed\n\n# Enable debug mode with console logs\nDEBUG_MODE=true npm test\n\n# Run single test with verbose output\nnpm test -- --test login --verbose --headed\n```\n\n### Screenshot Debugging\n\nTests automatically capture screenshots on failures. Manual screenshots:\n\n```javascript\n// In test files\nawait browser.screenshot('debug-point-1');\n```\n\n### Console Logs\n\n```bash\n# Enable browser console logging\nVERBOSE_LOGGING=true npm test\n\n# Save console logs to files\nSAVE_CONSOLE_LOGS=true npm test\n```\n\n## 🚦 CI/CD Integration\n\n### GitHub Actions\n\nThe test suite includes a comprehensive GitHub Actions workflow:\n\n```yaml\n# .github/workflows/e2e-tests.yml\n- Matrix testing across Node.js versions\n- Parallel test execution by suite\n- Automatic report generation\n- PR comments with results\n- Artifact uploads for reports and screenshots\n```\n\n### Running in CI\n\n```bash\n# Set CI environment variables\nexport CI=true\nexport HEADLESS=true\nexport SCREENSHOT_ON_FAILURE=true\n\n# Run tests\nnpm test\n```\n\n## 📋 Best Practices\n\n### Writing Tests\n\n1. **Use descriptive test names**: `should successfully create recipe with all required fields`\n2. **Follow AAA pattern**: Arrange, Act, Assert\n3. **Clean up after tests**: Use `beforeEach`/`afterEach` hooks\n4. **Handle async operations**: Always await promises\n5. **Use reliable selectors**: Prefer `data-testid` over CSS classes\n\n### Test Organization\n\n1. **Group related tests**: Use `describe` blocks for logical grouping\n2. **Keep tests independent**: Each test should work in isolation\n3. **Use helpers**: Extract common operations to helper classes\n4. **Maintain test data**: Use fixtures for consistent test data\n\n### Performance\n\n1. **Parallel execution**: Run independent test suites in parallel\n2. **Browser reuse**: Reuse browser instances where possible\n3. **Smart waiting**: Use explicit waits instead of arbitrary delays\n4. **Cleanup**: Close browsers and clean up resources\n\n## 🐛 Troubleshooting\n\n### Common Issues\n\n**Tests timing out**\n- Increase timeout values in `.env`\n- Check if services are running\n- Verify network connectivity\n\n**Element not found errors**\n- Verify `data-testid` attributes exist\n- Check for dynamic content loading\n- Ensure proper wait conditions\n\n**Authentication failures**\n- Verify test user credentials\n- Check backend authentication endpoints\n- Ensure database has test data\n\n**Flaky tests**\n- Add explicit waits for dynamic content\n- Increase retry counts\n- Check for race conditions\n\n### Debug Commands\n\n```bash\n# Check if services are running\ncurl http://localhost:5173  # Frontend\ncurl http://localhost:8080/health  # Backend\n\n# Run specific failing test\nnpm test -- --test \"specific test name\" --headed --verbose\n\n# Check test environment\nnode -e \"console.log(process.env)\" | grep -E \"(BASE_URL|API_BASE|TEST_)\"\n```\n\n## 🤝 Contributing\n\n### Adding New Tests\n\n1. Create test file in appropriate directory\n2. Use existing helpers and patterns\n3. Add required `data-testid` attributes to frontend\n4. Update this README with new test coverage\n5. Ensure tests pass in CI\n\n### Updating Helpers\n\n1. Maintain backward compatibility\n2. Add comprehensive JSDoc comments\n3. Update usage examples in README\n4. Test helper changes across all test files\n\n## 📝 License\n\nThis test suite is part of the Alchemorsel project and follows the same license terms.\n\n---\n\n**Happy Testing! 🧪✨**"